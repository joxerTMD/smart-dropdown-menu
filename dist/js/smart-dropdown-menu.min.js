/**
 * @yami-beta/smart-dropdown-menu
 *
 * Copyright (c) 2016 Takahiro Abe
 *
 * This software is released under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.SmartDropdownMenu=t()}(this,function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),n=function(){function n(t,i){e(this,n),this.el=t,this.index=i,this.el.classList.add("item"+this.index),this.el.addEventListener("mouseover",this.openSubmenu.bind(this)),this.el.addEventListener("mouseout",this.closeSubmenu.bind(this))}return t(n,[{key:"openSubmenu",value:function(){this.el.classList.add("show")}},{key:"closeSubmenu",value:function(){this.el.classList.remove("show")}}]),n}();return function(){function i(t){e(this,i),this.el=t,this.items=[];for(var s=document.querySelectorAll(".smart-dropdown-menu > .sdm-list > li"),o=0;o<s.length;o++)this.items.push(new n(s[o],o));this.el.addEventListener("mouseover",this.showMenu.bind(this)),this.el.addEventListener("mouseout",this.hideMenu.bind(this)),this.showMenu(),this.appendTriareaStyle(),this.hideMenu()}return t(i,[{key:"showMenu",value:function(e){this.el.classList.add("show")}},{key:"hideMenu",value:function(e){this.el.classList.remove("show")}},{key:"appendTriareaStyle",value:function(){var e=document.getElementById("smart-dropdown-menu-style");e||(e=document.createElement("style"),e.type="text/css",e.id="smart-dropdown-menu-style",document.querySelector("head").appendChild(e));var t=this.calculateTriarea();e.innerHTML=this.objectToStyle(t)}},{key:"calculateTriarea",value:function(){for(var e=this.el.querySelector("li"),t=e.offsetWidth,n=e.offsetHeight,i={},s=0;s<this.items.length;s++){this.items[s].openSubmenu();var o=Math.floor(180*Math.atan2(.5*t,n*s+n/2)/Math.PI);i[".item"+s+":before"]={height:n*s+n/2+"px",transform:"skewX(-"+o+"deg)"};var r=this.items[s].el.querySelector(".sdm-list").offsetHeight,u=r-n/2-n*s,a=Math.floor(180*Math.atan2(.5*t,u)/Math.PI);i[".item"+s+":after"]={"margin-top":"-"+n/2+"px",height:u+"px",transform:"skewX("+a+"deg)"},this.items[s].closeSubmenu()}return i}},{key:"objectToStyle",value:function(e){var t="";return Object.keys(e).forEach(function(n){t+=n+"{",Object.keys(e[n]).forEach(function(i){t+=i+": "+e[n][i]+";"}),t+="}"}),t}}]),i}()});
