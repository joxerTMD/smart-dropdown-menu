!function e(t,n,r){function i(u,s){if(!n[u]){if(!t[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[u]={exports:{}};t[u][0].call(c.exports,function(e){var n=t[u][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=e("./smart-dropdown-menu"),o=r(i);window.SmartDropdownMenu=o["default"]},{"./smart-dropdown-menu":3}],2:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.el=t,this.index=n,this.el.classList.add("item"+this.index),this.el.addEventListener("mouseover",this.openSubmenu.bind(this)),this.el.addEventListener("mouseout",this.closeSubmenu.bind(this))}return i(e,[{key:"openSubmenu",value:function(){this.el.classList.add("show")}},{key:"closeSubmenu",value:function(){this.el.classList.remove("show")}}]),e}();n["default"]=o},{}],3:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./smart-dropdown-menu-item"),s=r(u),a=function(){function e(t){i(this,e),this.el=t,this.items=[];for(var n=this.el.querySelectorAll(".menu-list > .menu-item"),r=0;r<n.length;r++)this.items.push(new s["default"](n[r],r));this.el.addEventListener("mouseover",this.showMenu.bind(this)),this.el.addEventListener("mouseout",this.hideMenu.bind(this)),this.showMenu(),this.appendTriareaStyle(),this.hideMenu()}return o(e,[{key:"showMenu",value:function(e){this.el.classList.add("show")}},{key:"hideMenu",value:function(e){this.el.classList.remove("show")}},{key:"appendTriareaStyle",value:function(){var e=document.getElementById("smart-dropdown-menu-style");e||(e=document.createElement("style"),e.type="text/css",e.id="smart-dropdown-menu-style",document.querySelector("head").appendChild(e));var t=this.calculateTriarea();e.innerHTML=this.objectToStyle(t)}},{key:"calculateTriarea",value:function(){for(var e=this.el.querySelector(".menu-item"),t=e.offsetWidth,n=e.offsetHeight,r={},i=0;i<this.items.length;i++){this.items[i].openSubmenu();var o=Math.floor(180*Math.atan2(.5*t,n*i+n/2)/Math.PI);r[".item"+i+":before"]={height:n*i+n/2+"px",transform:"skewX(-"+o+"deg)"};var u=this.items[i].el.querySelector(".submenu-list").offsetHeight,s=u-n/2-n*i,a=Math.floor(180*Math.atan2(.5*t,s)/Math.PI);r[".item"+i+":after"]={"margin-top":"-"+n/2+"px",height:s+"px",transform:"skewX("+a+"deg)"},this.items[i].closeSubmenu()}return r}},{key:"objectToStyle",value:function(e){var t="";return Object.keys(e).forEach(function(n){t+=n+"{",Object.keys(e[n]).forEach(function(r){t+=r+": "+e[n][r]+";"}),t+="}"}),t}}]),e}();n["default"]=a},{"./smart-dropdown-menu-item":2}]},{},[1]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzbWFydC1kcm9wZG93bi1tZW51LmpzIiwic3JjL2pzL2FwcC5qcyIsInNyYy9qcy9zbWFydC1kcm9wZG93bi1tZW51LWl0ZW0uanMiLCJzcmMvanMvc21hcnQtZHJvcGRvd24tbWVudS5qcyJdLCJuYW1lcyI6WyJlIiwidCIsIm4iLCJyIiwicyIsIm8iLCJ1IiwiYSIsInJlcXVpcmUiLCJpIiwiZiIsIkVycm9yIiwiY29kZSIsImwiLCJleHBvcnRzIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJtb2R1bGUiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfc21hcnREcm9wZG93bk1lbnUiLCJfc21hcnREcm9wZG93bk1lbnUyIiwid2luZG93IiwiU21hcnREcm9wZG93bk1lbnUiLCIuL3NtYXJ0LWRyb3Bkb3duLW1lbnUiLCIyIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiU21hcnREcm9wZG93bk1lbnVJdGVtIiwiZWwiLCJpbmRleCIsInRoaXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwib3BlblN1Ym1lbnUiLCJiaW5kIiwiY2xvc2VTdWJtZW51IiwicmVtb3ZlIiwiMyIsIl9zbWFydERyb3Bkb3duTWVudUl0ZW0iLCJfc21hcnREcm9wZG93bk1lbnVJdGVtMiIsIm5vZGUiLCJpdGVtcyIsIm1lbnVJdGVtIiwicXVlcnlTZWxlY3RvckFsbCIsInB1c2giLCJzaG93TWVudSIsImhpZGVNZW51IiwiYXBwZW5kVHJpYXJlYVN0eWxlIiwiZXZlbnQiLCJjYXRlZ29yeU1lbnVTdHlsZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjcmVhdGVFbGVtZW50IiwidHlwZSIsImlkIiwicXVlcnlTZWxlY3RvciIsImFwcGVuZENoaWxkIiwic3R5bGVPYmoiLCJjYWxjdWxhdGVUcmlhcmVhIiwiaW5uZXJIVE1MIiwib2JqZWN0VG9TdHlsZSIsIm1lbnVMaXN0U3ViIiwibWVudUl0ZW1XaWR0aCIsIm9mZnNldFdpZHRoIiwibWVudUl0ZW1IZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJjYXRlZ29yeU1lbnVTdHlsZU9iaiIsImVsZXZhdGlvbiIsIk1hdGgiLCJmbG9vciIsImF0YW4yIiwiUEkiLCJoZWlnaHQiLCJ0cmFuc2Zvcm0iLCJzdWJtZW51SGVpZ2h0IiwiZGVwcmVzc2lvbiIsIm1hcmdpbi10b3AiLCJzdHlsZVRleHQiLCJrZXlzIiwiZm9yRWFjaCIsInNlbGVjdG9yIiwicHJvcGVydHkiLCIuL3NtYXJ0LWRyb3Bkb3duLW1lbnUtaXRlbSJdLCJtYXBwaW5ncyI6IkNBQUEsUUFBQUEsR0FBQUMsRUFBQUMsRUFBQUMsR0FBQSxRQUFBQyxHQUFBQyxFQUFBQyxHQUFBLElBQUFKLEVBQUFHLEdBQUEsQ0FBQSxJQUFBSixFQUFBSSxHQUFBLENBQUEsR0FBQUUsR0FBQSxrQkFBQUMsVUFBQUEsT0FBQSxLQUFBRixHQUFBQyxFQUFBLE1BQUFBLEdBQUFGLEdBQUEsRUFBQSxJQUFBSSxFQUFBLE1BQUFBLEdBQUFKLEdBQUEsRUFBQSxJQUFBSyxHQUFBLEdBQUFDLE9BQUEsdUJBQUFOLEVBQUEsSUFBQSxNQUFBSyxHQUFBRSxLQUFBLG1CQUFBRixFQUFBLEdBQUFHLEdBQUFYLEVBQUFHLElBQUFTLFdBQUFiLEdBQUFJLEdBQUEsR0FBQVUsS0FBQUYsRUFBQUMsUUFBQSxTQUFBZCxHQUFBLEdBQUFFLEdBQUFELEVBQUFJLEdBQUEsR0FBQUws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LE9BQVFQLElBQUssQ0FDekMwQyxLQUFLWSxNQUFNdEQsR0FBRzhDLGFBR2QsSUFBTWtDLEdBQVlDLEtBQUtDLE1BQWlGLElBQTNFRCxLQUFLRSxNQUFzQixHQUFoQlIsRUFBcUJFLEVBQWlCN0UsRUFBSTZFLEVBQWlCLEdBQVdJLEtBQUtHLEdBQ25ITCxHQUFBLFFBQTZCL0UsRUFBN0IsWUFDRXFGLE9BQWFSLEVBQWlCN0UsRUFBSTZFLEVBQWlCLEVBQW5ELEtBQ0FTLFVBQUEsVUFBdUJOLEVBQXZCLE9BR0YsSUFBTU8sR0FBZ0I3QyxLQUFLWSxNQUFNdEQsR0FBR3dDLEdBQUc0QixjQUFjLGlCQUFpQlUsYUFDaEVPLEVBQVVFLEVBQWdCVixFQUFpQixFQUFLQSxFQUFpQjdFLEVBRWpFd0YsRUFBYVAsS0FBS0MsTUFBZ0QsSUFBMUNELEtBQUtFLE1BQXNCLEdBQWhCUixFQUFxQlUsR0FBZ0JKLEtBQUtHLEdBQ25GTCxHQUFBLFFBQTZCL0UsRUFBN0IsV0FDRXlGLGFBQUEsSUFBa0JaLEVBQWlCLEVBQW5DLEtBQ0FRLE9BQWFBLEVBQWIsS0FDQUMsVUFBQSxTQUFzQkUsRUFBdEIsUUFHRjlDLEtBQUtZLE1BQU10RCxHQUFHZ0QsZUFHaEIsTUFBTytCLE1INEVQNUMsSUFBSyxnQkFDTFQsTUFBTyxTRzFFS2YsR0FDWixHQUFJK0UsR0FBWSxFQVFoQixPQVBBbEUsUUFBT21FLEtBQUtoRixHQUFLaUYsUUFBUSxTQUFDQyxHQUN4QkgsR0FBYUcsRUFBVyxJQUN4QnJFLE9BQU9tRSxLQUFLaEYsRUFBSWtGLElBQVdELFFBQVEsU0FBQ0UsR0FDbENKLEdBQWdCSSxFQUFoQixLQUE2Qm5GLEVBQUlrRixHQUFVQyxHQUEzQyxNQUVGSixHQUFhLE1BRVJBLE1IOEVGekUsSUFHVFosR0FBQUEsV0dqS3FCWSxJSG1LbEI4RSw2QkFBNkIsU0FBUyIsImZpbGUiOiJzbWFydC1kcm9wZG93bi1tZW51LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfc21hcnREcm9wZG93bk1lbnUgPSByZXF1aXJlKCcuL3NtYXJ0LWRyb3Bkb3duLW1lbnUnKTtcblxudmFyIF9zbWFydERyb3Bkb3duTWVudTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zbWFydERyb3Bkb3duTWVudSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbndpbmRvdy5TbWFydERyb3Bkb3duTWVudSA9IF9zbWFydERyb3Bkb3duTWVudTIuZGVmYXVsdDtcblxufSx7XCIuL3NtYXJ0LWRyb3Bkb3duLW1lbnVcIjozfV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBTbWFydERyb3Bkb3duTWVudUl0ZW0gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFNtYXJ0RHJvcGRvd25NZW51SXRlbShlbCwgaW5kZXgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU21hcnREcm9wZG93bk1lbnVJdGVtKTtcblxuICAgIHRoaXMuZWwgPSBlbDtcbiAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdpdGVtJyArIHRoaXMuaW5kZXgpO1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCB0aGlzLm9wZW5TdWJtZW51LmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCB0aGlzLmNsb3NlU3VibWVudS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhTbWFydERyb3Bkb3duTWVudUl0ZW0sIFt7XG4gICAga2V5OiAnb3BlblN1Ym1lbnUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuU3VibWVudSgpIHtcbiAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2Nsb3NlU3VibWVudScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlU3VibWVudSgpIHtcbiAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBTbWFydERyb3Bkb3duTWVudUl0ZW07XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFNtYXJ0RHJvcGRvd25NZW51SXRlbTtcblxufSx7fV0sMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfc21hcnREcm9wZG93bk1lbnVJdGVtID0gcmVxdWlyZSgnLi9zbWFydC1kcm9wZG93bi1tZW51LWl0ZW0nKTtcblxudmFyIF9zbWFydERyb3Bkb3duTWVudUl0ZW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc21hcnREcm9wZG93bk1lbnVJdGVtKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFNtYXJ0RHJvcGRvd25NZW51ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTbWFydERyb3Bkb3duTWVudShub2RlKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNtYXJ0RHJvcGRvd25NZW51KTtcblxuICAgIHRoaXMuZWwgPSBub2RlO1xuICAgIHRoaXMuaXRlbXMgPSBbXTtcblxuICAgIHZhciBtZW51SXRlbSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtbGlzdCA+IC5tZW51LWl0ZW0nKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1lbnVJdGVtLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLml0ZW1zLnB1c2gobmV3IF9zbWFydERyb3Bkb3duTWVudUl0ZW0yLmRlZmF1bHQobWVudUl0ZW1baV0sIGkpKTtcbiAgICB9XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHRoaXMuc2hvd01lbnUuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIHRoaXMuaGlkZU1lbnUuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5zaG93TWVudSgpO1xuICAgIHRoaXMuYXBwZW5kVHJpYXJlYVN0eWxlKCk7XG4gICAgdGhpcy5oaWRlTWVudSgpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFNtYXJ0RHJvcGRvd25NZW51LCBbe1xuICAgIGtleTogJ3Nob3dNZW51JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvd01lbnUoZXZlbnQpIHtcbiAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2hpZGVNZW51JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGlkZU1lbnUoZXZlbnQpIHtcbiAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2FwcGVuZFRyaWFyZWFTdHlsZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZFRyaWFyZWFTdHlsZSgpIHtcbiAgICAgIC8vIDxzdHlsZT4gZm9yIHRyaWFyZWFcbiAgICAgIHZhciBjYXRlZ29yeU1lbnVTdHlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbWFydC1kcm9wZG93bi1tZW51LXN0eWxlJyk7XG4gICAgICBpZiAoIWNhdGVnb3J5TWVudVN0eWxlKSB7XG4gICAgICAgIGNhdGVnb3J5TWVudVN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgY2F0ZWdvcnlNZW51U3R5bGUudHlwZSA9ICd0ZXh0L2Nzcyc7XG4gICAgICAgIGNhdGVnb3J5TWVudVN0eWxlLmlkID0gJ3NtYXJ0LWRyb3Bkb3duLW1lbnUtc3R5bGUnO1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkJykuYXBwZW5kQ2hpbGQoY2F0ZWdvcnlNZW51U3R5bGUpO1xuICAgICAgfVxuICAgICAgdmFyIHN0eWxlT2JqID0gdGhpcy5jYWxjdWxhdGVUcmlhcmVhKCk7XG4gICAgICBjYXRlZ29yeU1lbnVTdHlsZS5pbm5lckhUTUwgPSB0aGlzLm9iamVjdFRvU3R5bGUoc3R5bGVPYmopO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2NhbGN1bGF0ZVRyaWFyZWEnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjYWxjdWxhdGVUcmlhcmVhKCkge1xuICAgICAgLy8gXCJ0cmlhcmVhXCIgZXh0ZW5kIGhvdmVyIGFyZWEgb2YgbWVudSBmb3IgbW91c2UgY3Vyc29yJ3MgZGlhZ29uYWwgbW92ZW1lbnRcbiAgICAgIHZhciBtZW51TGlzdFN1YiA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLm1lbnUtaXRlbScpO1xuICAgICAgdmFyIG1lbnVJdGVtV2lkdGggPSBtZW51TGlzdFN1Yi5vZmZzZXRXaWR0aDtcbiAgICAgIHZhciBtZW51SXRlbUhlaWdodCA9IG1lbnVMaXN0U3ViLm9mZnNldEhlaWdodDtcbiAgICAgIHZhciBjYXRlZ29yeU1lbnVTdHlsZU9iaiA9IHt9O1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5pdGVtc1tpXS5vcGVuU3VibWVudSgpO1xuXG4gICAgICAgIC8vIGNhbGMgYW5nbGUgb2YgZWxldmF0aW9uXG4gICAgICAgIHZhciBlbGV2YXRpb24gPSBNYXRoLmZsb29yKE1hdGguYXRhbjIobWVudUl0ZW1XaWR0aCAqIDAuNSwgbWVudUl0ZW1IZWlnaHQgKiBpICsgbWVudUl0ZW1IZWlnaHQgLyAyKSAqIDE4MCAvIE1hdGguUEkpO1xuICAgICAgICBjYXRlZ29yeU1lbnVTdHlsZU9ialsnLml0ZW0nICsgaSArICc6YmVmb3JlJ10gPSB7XG4gICAgICAgICAgJ2hlaWdodCc6IG1lbnVJdGVtSGVpZ2h0ICogaSArIG1lbnVJdGVtSGVpZ2h0IC8gMiArICdweCcsXG4gICAgICAgICAgJ3RyYW5zZm9ybSc6ICdza2V3WCgtJyArIGVsZXZhdGlvbiArICdkZWcpJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBzdWJtZW51SGVpZ2h0ID0gdGhpcy5pdGVtc1tpXS5lbC5xdWVyeVNlbGVjdG9yKCcuc3VibWVudS1saXN0Jykub2Zmc2V0SGVpZ2h0O1xuICAgICAgICB2YXIgaGVpZ2h0ID0gc3VibWVudUhlaWdodCAtIG1lbnVJdGVtSGVpZ2h0IC8gMiAtIG1lbnVJdGVtSGVpZ2h0ICogaTtcbiAgICAgICAgLy8gY2FsYyBhbmdsZSBvZiBkZXByZXNzaW9uXG4gICAgICAgIHZhciBkZXByZXNzaW9uID0gTWF0aC5mbG9vcihNYXRoLmF0YW4yKG1lbnVJdGVtV2lkdGggKiAwLjUsIGhlaWdodCkgKiAxODAgLyBNYXRoLlBJKTtcbiAgICAgICAgY2F0ZWdvcnlNZW51U3R5bGVPYmpbJy5pdGVtJyArIGkgKyAnOmFmdGVyJ10gPSB7XG4gICAgICAgICAgJ21hcmdpbi10b3AnOiAnLScgKyBtZW51SXRlbUhlaWdodCAvIDIgKyAncHgnLFxuICAgICAgICAgICdoZWlnaHQnOiBoZWlnaHQgKyAncHgnLFxuICAgICAgICAgICd0cmFuc2Zvcm0nOiAnc2tld1goJyArIGRlcHJlc3Npb24gKyAnZGVnKSdcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLml0ZW1zW2ldLmNsb3NlU3VibWVudSgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2F0ZWdvcnlNZW51U3R5bGVPYmo7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnb2JqZWN0VG9TdHlsZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9iamVjdFRvU3R5bGUob2JqKSB7XG4gICAgICB2YXIgc3R5bGVUZXh0ID0gJyc7XG4gICAgICBPYmplY3Qua2V5cyhvYmopLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgICAgIHN0eWxlVGV4dCArPSBzZWxlY3RvciArICd7JztcbiAgICAgICAgT2JqZWN0LmtleXMob2JqW3NlbGVjdG9yXSkuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHkpIHtcbiAgICAgICAgICBzdHlsZVRleHQgKz0gcHJvcGVydHkgKyAnOiAnICsgb2JqW3NlbGVjdG9yXVtwcm9wZXJ0eV0gKyAnOyc7XG4gICAgICAgIH0pO1xuICAgICAgICBzdHlsZVRleHQgKz0gJ30nO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gc3R5bGVUZXh0O1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBTbWFydERyb3Bkb3duTWVudTtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gU21hcnREcm9wZG93bk1lbnU7XG5cbn0se1wiLi9zbWFydC1kcm9wZG93bi1tZW51LWl0ZW1cIjoyfV19LHt9LFsxXSlcblxuIiwiaW1wb3J0IFNtYXJ0RHJvcGRvd25NZW51IGZyb20gJy4vc21hcnQtZHJvcGRvd24tbWVudSc7XG5cbndpbmRvdy5TbWFydERyb3Bkb3duTWVudSA9IFNtYXJ0RHJvcGRvd25NZW51O1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU21hcnREcm9wZG93bk1lbnVJdGVtIHtcbiAgY29uc3RydWN0b3IoZWwsIGluZGV4KSB7XG4gICAgdGhpcy5lbCA9IGVsO1xuICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoYGl0ZW0ke3RoaXMuaW5kZXh9YClcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5vcGVuU3VibWVudS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgdGhpcy5jbG9zZVN1Ym1lbnUuYmluZCh0aGlzKSk7XG4gIH1cblxuICBvcGVuU3VibWVudSgpIHtcbiAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgfVxuICBjbG9zZVN1Ym1lbnUoKSB7XG4gICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gIH1cbn1cbiIsImltcG9ydCBTbWFydERyb3Bkb3duTWVudUl0ZW0gZnJvbSAnLi9zbWFydC1kcm9wZG93bi1tZW51LWl0ZW0nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTbWFydERyb3Bkb3duTWVudSB7XG4gIGNvbnN0cnVjdG9yKG5vZGUpIHtcbiAgICB0aGlzLmVsID0gbm9kZTtcbiAgICB0aGlzLml0ZW1zID0gW107XG5cbiAgICBjb25zdCBtZW51SXRlbSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtbGlzdCA+IC5tZW51LWl0ZW0nKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lbnVJdGVtLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLml0ZW1zLnB1c2gobmV3IFNtYXJ0RHJvcGRvd25NZW51SXRlbShtZW51SXRlbVtpXSwgaSkpO1xuICAgIH1cblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5zaG93TWVudS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgdGhpcy5oaWRlTWVudS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnNob3dNZW51KCk7XG4gICAgdGhpcy5hcHBlbmRUcmlhcmVhU3R5bGUoKTtcbiAgICB0aGlzLmhpZGVNZW51KCk7XG4gIH1cblxuICBzaG93TWVudShldmVudCkge1xuICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICB9XG5cbiAgaGlkZU1lbnUoZXZlbnQpIHtcbiAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgfVxuXG4gIGFwcGVuZFRyaWFyZWFTdHlsZSgpIHtcbiAgICAvLyA8c3R5bGU+IGZvciB0cmlhcmVhXG4gICAgbGV0IGNhdGVnb3J5TWVudVN0eWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NtYXJ0LWRyb3Bkb3duLW1lbnUtc3R5bGUnKTtcbiAgICBpZiAoIWNhdGVnb3J5TWVudVN0eWxlKSB7XG4gICAgICBjYXRlZ29yeU1lbnVTdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICBjYXRlZ29yeU1lbnVTdHlsZS50eXBlID0gJ3RleHQvY3NzJztcbiAgICAgIGNhdGVnb3J5TWVudVN0eWxlLmlkID0gJ3NtYXJ0LWRyb3Bkb3duLW1lbnUtc3R5bGUnO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZCcpLmFwcGVuZENoaWxkKGNhdGVnb3J5TWVudVN0eWxlKTtcbiAgICB9XG4gICAgY29uc3Qgc3R5bGVPYmogPSB0aGlzLmNhbGN1bGF0ZVRyaWFyZWEoKTtcbiAgICBjYXRlZ29yeU1lbnVTdHlsZS5pbm5lckhUTUwgPSB0aGlzLm9iamVjdFRvU3R5bGUoc3R5bGVPYmopO1xuICB9XG5cbiAgY2FsY3VsYXRlVHJpYXJlYSgpIHtcbiAgICAvLyBcInRyaWFyZWFcIiBleHRlbmQgaG92ZXIgYXJlYSBvZiBtZW51IGZvciBtb3VzZSBjdXJzb3IncyBkaWFnb25hbCBtb3ZlbWVudFxuICAgIGNvbnN0IG1lbnVMaXN0U3ViID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubWVudS1pdGVtJyk7XG4gICAgY29uc3QgbWVudUl0ZW1XaWR0aCA9IG1lbnVMaXN0U3ViLm9mZnNldFdpZHRoO1xuICAgIGNvbnN0IG1lbnVJdGVtSGVpZ2h0ID0gbWVudUxpc3RTdWIub2Zmc2V0SGVpZ2h0O1xuICAgIGxldCBjYXRlZ29yeU1lbnVTdHlsZU9iaiA9IHt9O1xuXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuaXRlbXNbaV0ub3BlblN1Ym1lbnUoKTtcblxuICAgICAgLy8gY2FsYyBhbmdsZSBvZiBlbGV2YXRpb25cbiAgICAgIGNvbnN0IGVsZXZhdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5hdGFuMihtZW51SXRlbVdpZHRoICogMC41LCBtZW51SXRlbUhlaWdodCAqIGkgKyBtZW51SXRlbUhlaWdodCAvIDIpICogMTgwIC8gTWF0aC5QSSk7XG4gICAgICBjYXRlZ29yeU1lbnVTdHlsZU9ialtgLml0ZW0ke2l9OmJlZm9yZWBdID0ge1xuICAgICAgICAnaGVpZ2h0JzogYCR7bWVudUl0ZW1IZWlnaHQgKiBpICsgbWVudUl0ZW1IZWlnaHQgLyAyfXB4YCxcbiAgICAgICAgJ3RyYW5zZm9ybSc6IGBza2V3WCgtJHtlbGV2YXRpb259ZGVnKWAsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzdWJtZW51SGVpZ2h0ID0gdGhpcy5pdGVtc1tpXS5lbC5xdWVyeVNlbGVjdG9yKCcuc3VibWVudS1saXN0Jykub2Zmc2V0SGVpZ2h0O1xuICAgICAgY29uc3QgaGVpZ2h0ID0gKHN1Ym1lbnVIZWlnaHQgLSBtZW51SXRlbUhlaWdodCAvIDIpIC0gbWVudUl0ZW1IZWlnaHQgKiBpO1xuICAgICAgLy8gY2FsYyBhbmdsZSBvZiBkZXByZXNzaW9uXG4gICAgICBjb25zdCBkZXByZXNzaW9uID0gTWF0aC5mbG9vcihNYXRoLmF0YW4yKG1lbnVJdGVtV2lkdGggKiAwLjUsIGhlaWdodCkgKiAxODAgLyBNYXRoLlBJKTtcbiAgICAgIGNhdGVnb3J5TWVudVN0eWxlT2JqW2AuaXRlbSR7aX06YWZ0ZXJgXSA9IHtcbiAgICAgICAgJ21hcmdpbi10b3AnOiBgLSR7bWVudUl0ZW1IZWlnaHQgLyAyfXB4YCxcbiAgICAgICAgJ2hlaWdodCc6IGAke2hlaWdodH1weGAsXG4gICAgICAgICd0cmFuc2Zvcm0nOiBgc2tld1goJHtkZXByZXNzaW9ufWRlZylgLFxuICAgICAgfTtcblxuICAgICAgdGhpcy5pdGVtc1tpXS5jbG9zZVN1Ym1lbnUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2F0ZWdvcnlNZW51U3R5bGVPYmo7XG4gIH1cblxuICBvYmplY3RUb1N0eWxlKG9iaikge1xuICAgIGxldCBzdHlsZVRleHQgPSAnJztcbiAgICBPYmplY3Qua2V5cyhvYmopLmZvckVhY2goKHNlbGVjdG9yKSA9PiB7XG4gICAgICBzdHlsZVRleHQgKz0gc2VsZWN0b3IgKyAneyc7XG4gICAgICBPYmplY3Qua2V5cyhvYmpbc2VsZWN0b3JdKS5mb3JFYWNoKChwcm9wZXJ0eSkgPT4ge1xuICAgICAgICBzdHlsZVRleHQgKz0gYCR7cHJvcGVydHl9OiAke29ialtzZWxlY3Rvcl1bcHJvcGVydHldfTtgO1xuICAgICAgfSk7XG4gICAgICBzdHlsZVRleHQgKz0gJ30nO1xuICAgIH0pO1xuICAgIHJldHVybiBzdHlsZVRleHQ7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
